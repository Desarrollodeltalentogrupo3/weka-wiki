<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://github.com/Waikato/weka-wiki/experimenter/remote_experiment/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Remote experiment - Weka Wiki</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Remote experiment";
        var mkdocs_page_input_path = "experimenter/remote_experiment.md";
        var mkdocs_page_url = "/Waikato/weka-wiki/experimenter/remote_experiment/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Weka Wiki
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../downloading_weka/">Downloading and installing Weka</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../requirements/">Requirements</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../documentation/">Documentation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../getting_help/">Getting help</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../citing_weka/">Citing Weka</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../literature/">Literature</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../development/">Development</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../history/">History</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Resources</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../not_so_faq/">Not so FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../using_the_api/">Using the API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../extending_weka/">Extending Weka</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../formats_and_processing/arff/">ARFF Format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../primer/">Primer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../datasets/">Datasets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../visualization_articles/">Visualization Articles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../properties_file/">Properties File</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../packages/">Packages</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../experimenter/">Experimenter</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Weka Wiki</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Remote experiment</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p>Remote experiments enable you to distribute the computing load across multiple computers. In the following we will discuss the setup and operation for <a href="http://hsqldb.sourceforge.net/">HSQLDB</a> and <a href="http://www.mysql.com/">MySQL</a>.</p>
<h3 id="preparation">Preparation</h3>
<p>To run a remote experiment you will need:</p>
<ul>
<li>A database server.</li>
<li>A number of computers to run remote engines on.</li>
<li>To edit the remote engine policy file included in the Weka distribution to allow class and dataset loading from your home directory.</li>
<li>An invocation of the Experimenter on a machine somewhere (any will do).</li>
</ul>
<p>For the following examples, we assume a user called <em>johndoe</em> with this setup:</p>
<ul>
<li>Access to a set of computers running a flavour of Unix (pathnames need to be changed for Windows).</li>
<li>The home directory is located at <code>/home/johndoe</code>.</li>
<li>Weka is found in <code>/home/johndoe/weka</code>.</li>
<li>Additional jar archives, i.e., JDBC drivers, are stored in <code>/home/johndoe/jars</code>.</li>
<li>The directory for the datasets is <code>/home/johndoe/datasets</code>.</li>
</ul>
<p><strong>Note:</strong> The example policy file <code>remote.policy.example</code> is using this setup (available in <code>weka/experiment</code>). </p>
<h3 id="database-server-setup">Database Server Setup</h3>
<ul>
<li>HSQLDB
<strong> Download the JDBC driver for HSQLDB, extract the <code>hsqldb.jar</code> and place it in the directory <code>/home/johndoe/jars</code>.
</strong> To set up the database server, choose or create a directory to run the database server from, and start the server with:</li>
</ul>
<pre><code class="language-bash"> java -classpath /home/johndoe/jars/hsqldb.jar \
   org.hsqldb.Server -database.0 experiment -dbname.0 experiment
</code></pre>
<blockquote>
<p><strong>Note:</strong> This will start up a database with the alias <em>experiment</em> (<code>-dbname.0 &lt;alias&gt;</code>) and create a properties and a log file at the current location prefixed with <em>experiment</em> (<code>-database.0 &lt;file&gt;</code>).</p>
</blockquote>
<ul>
<li>MySQL<blockquote>
<p>We won't go into details of setting up a MySQL server, but this is rather straightforward and includes the following steps:</p>
</blockquote>
</li>
</ul>
<p><strong> Download a suitable version of MySQL for your server machine.
</strong> Start the MySQL server.
<strong> Create a database - for our example we will use experiment as database name.
</strong> Download the appropriate JDBC driver, extract the JDBC jar and place it as <code>mysql.jar</code> in <code>/home/johndoe/jars</code>.</p>
<h3 id="remote-engine-setup">Remote Engine Setup</h3>
<ul>
<li>First, set up a directory for scripts and policy files:</li>
</ul>
<pre><code class="language-bash"> /home/johndoe/remote_engine
</code></pre>
<ul>
<li>Unzip the <code>remoteExperimentServer.jar</code> (from the Weka distribution; or build it from the sources with <code>ant remotejar</code>) into a temporary directory.</li>
<li>Next, copy the remoteEngine.jar to the <code>/home/johndoe/remote_engine</code> directory.</li>
<li>Create a script, called <code>/home/johndoe/remote_engine/startRemoteEngine</code>, with the following content (don't forget to make it executable with <code>chmod a+x startRemoteEngine</code>):</li>
</ul>
<blockquote>
<ul>
<li>HSQLDB</li>
</ul>
</blockquote>
<pre><code class="language-bash"> java -Xmx256m \
   -classpath /home/johndoe/jars/hsqldb.jar:remoteEngine.jar \
   -Djava.security.policy=remote.policy \
   weka.experiment.RemoteEngine &amp;
</code></pre>
<blockquote>
<ul>
<li>MySQL</li>
</ul>
</blockquote>
<pre><code class="language-bash"> java -Xmx256m \
   -classpath /home/johndoe/jars/mysql.jar:remoteEngine.jar \
   -Djava.security.policy=remote.policy \
   weka.experiment.RemoteEngine &amp;
</code></pre>
<blockquote>
<ul>
<li>From Weka 3.7.2 you will need to include the core weka.jar file in the classpath for the RemoteEngine. Assuming that the weka.jar file has been copied to <code>/home/johndoe/remote_engine</code>:</li>
</ul>
</blockquote>
<pre><code class="language-bash">java -Xmx256m \
  -classpath /home/johndoe/jars/hsqldb.jar:remoteEngine.jar:weka.jar \
  -Djava.security.policy=remote.policy \
  weka.experiment.RemoteEngine &amp;
</code></pre>
<ul>
<li>
<p>Now we will start the remote engines (note that the same version of Java must be used for the Experimenter and remote engines) :</p>
<ul>
<li>Copy the <code>remote.policy.example</code> file to <code>/home/johndoe/remote_engine</code> as <code>remote.policy</code>.</li>
<li>
<p>For each machine you want to run an engine on:</p>
<ul>
<li><code>ssh</code> to the machine.</li>
<li><code>cd</code> to <code>/home/johndoe/remote_engine</code>.</li>
<li>Run <code>/home/johndoe/startRemoteEngine</code> (to enable the remote engines to use more memory, modify the <code>-Xmx</code> option in the <code>startRemoteEngine</code> script) .</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="configuring-the-experimenter">Configuring the Experimenter</h3>
<p>Now we will run the Experimenter:</p>
<ul>
<li>HSQLDB<ul>
<li>Copy the <em>DatabaseUtils.props.hsql</em> file to the <code>/home/johndoe/remote_engine</code> directory and rename it to <em>DatabaseUtils.props</em> - a copy comes with your Weka distribution in <code>weka/experiment</code>.</li>
<li>Edit this file and change the "<code>jdbcURL=jdbc:hsqldb:hsql://server_name/database_name</code>" entry to include the name of the machine that is running your database server (e.g., <code>jdbcURL=jdbc:hsqldb:hsql://dodo.company.com/experiment</code>).</li>
<li>Now start the experimenter (inside this directory):</li>
</ul>
</li>
</ul>
<pre><code class="language-bash"> java \
   -cp /home/johndoe/jars/hsqldb.jar:remoteEngine.jar:/home/johndoe/weka/weka.jar \
   -Djava.rmi.server.codebase=file:/home/johndoe/weka/weka.jar \
   weka.gui.experiment.Experimenter
</code></pre>
<ul>
<li>MySQL<ul>
<li>Copy the <em>DatabaseUtils.props.mysql</em> file to the <code>/home/johndoe/remote_engine</code> directory and rename it to <em>DatabaseUtils.props</em> - a copy comes with your Weka distribution in <code>weka/experiment</code>.</li>
<li>Edit this file and change the "<code>jdbcURL=jdbc:mysql://server_name:3306/database_name</code>" entry to include the name of the machine that is running your database server and the name of the database the result will be stored in (e.g., <code>jdbcURL=jdbc:mysql://dodo.company.com:3306/experiment</code>).</li>
<li>Now start the experimenter (inside this directory):</li>
</ul>
</li>
</ul>
<pre><code class="language-bash"> java \
   -cp /home/johndoe/jars/mysql.jar:remoteEngine.jar:/home/johndoe/weka/weka.jar \
   -Djava.rmi.server.codebase=file:/home/johndoe/weka/weka.jar \
   weka.gui.experiment.Experimenter
</code></pre>
<blockquote>
<p><strong>Note:</strong> the database name experiment can be still modified in the Experimenter, this is just the default setup. </p>
</blockquote>
<p>Now we will configure the experiment:</p>
<ul>
<li>First of all select the <em>Advanced</em> mode in the Setup tab</li>
<li>
<p>Now choose the <em>DatabaseResultListener</em> in the <em>Destination</em> panel. Configure this result producer:</p>
<ul>
<li>HSQLDB<blockquote>
<blockquote>
<p>Supply the value <strong>sa</strong> for the username and leave the password empty.</p>
</blockquote>
</blockquote>
</li>
<li>MySQL<blockquote>
<blockquote>
<p>Provide username and password that you need for connecting to the database.</p>
</blockquote>
</blockquote>
</li>
</ul>
</li>
<li>
<p>From the Result generator panel choose either the <em>CrossValidationResultProducer</em> or the <em>RandomSplitResultProducer</em> (these are the most commonly used ones) and then configure the remaining experiment details (e.g., datasets and classifiers).</p>
</li>
<li>Now enable the <em>Distribute Experiment</em> panel by checking the tick box.</li>
<li>Click on the <em>Hosts</em> button and enter the names of the machines that you started remote engines on (<code>&lt;Enter&gt;</code> adds the host to the list).</li>
<li>You can choose to distribute by run or dataset (try to get a balance).</li>
<li>Save your experiment configuration.</li>
<li>Now start your experiment as you would do normally.</li>
<li>Check your results in the <em>Analyse</em> tab by clicking either the <em>Database</em> or <em>Experiment</em> buttons.</li>
</ul>
<h3 id="multi-core-support">Multi-core support</h3>
<p>If you want to utilize all the cores on a multi-core machine, then you can do so with Weka version 3.6.x and developer versions later than 3.5.7. All you have to do, is define the port alongside the hostname in the Experimenter (format: 
<code>hostname:port</code>) and then start the <code>RemoteEngine</code> with the <code>-p</code> option, specifying the port to listen on.
See also <a href="https://list.waikato.ac.nz/pipermail/wekalist/2009-March/016310.html">this</a> post on the <a href="../../mailing_list/">Wekalist</a>.</p>
<h3 id="troubleshooting">Troubleshooting</h3>
<ul>
<li>If you get an error at the start of an experiment that looks a bit like this:</li>
</ul>
<pre><code>{{01:13:19: RemoteExperiment (//blabla.company.com/RemoteEngine) (sub)experiment (datataset vineyard.arff) failed : java.sql.SQLException: Table already exists: EXPERIMENT_INDEX in statement [CREATE TABLE Experiment_index ( Experiment_type LONGVARCHAR, Experiment_setup LONGVARCHAR, Result_table INT )]

01:13:19: dataset :vineyard.arff RemoteExperiment

       (//blabla.company.com/RemoteEngine) (sub)experiment (datataset vineyard.arff) failed : java.sql.SQLException: Table already exists: EXPERIMENT_INDEX in statement [CREATE TABLE Experiment_index ( Experiment_type LONGVARCHAR, Experiment_setup LONGVARCHAR, Result_table INT )]. Scheduling for execution on another host.}}
</code></pre>
<blockquote>
<p>then do not panic - this happens because multiple remote machines are trying to create the same table and are temporarily locked out - this will resolve itself so just leave your experiment running - in fact, it is a sign that the experiment is working!</p>
</blockquote>
<ul>
<li>If you serialized an experiment and then modify your <code>DatabaseUtils.props</code> file due to an error (e.g., a missing type-mapping), the Experimenter will use the <code>DatabaseUtils.props</code> you had at the time you serialized the experiment. Keep in mind that the serialization process also serializes the DatabaseUtils class and therefore stored your props-file! This is another reason for storing your experiments as XML and not in the properietary binary format the Java serialization produces.</li>
<li>Using a corrupt or incomplete <code>DatabaseUtils.props</code> file can cause peculiar interface errors, for example disabling the use of the <em>User</em> button alongside the database URL. If in doubt copy a clean <code>DatabaseUtils.props</code> from <a href="../../subversion/">Subversion</a>.</li>
<li>If you get <code>NullPointerException at java.util.Hashtable.get()</code> in the Remote Engine do not be alarmed. This will have no effect on the results of your experiment.</li>
</ul>
<h3 id="links">Links</h3>
<ul>
<li><a href="../../databases/">Databases</a></li>
<li><a href="../../weka_experiment_database_utils.props/">weka/experiment/DatabaseUtils.props</a></li>
<li><a href="../../subversion/">Subversion</a></li>
<li><a href="http://hsqldb.sourceforge.net/">HSQLDB</a></li>
<li><a href="http://www.mysql.com/">MySQL</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
